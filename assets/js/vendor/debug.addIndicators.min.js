/*!
 * @file Debug Extension for ScrollMagic.
 */
!function(e,r){"function"==typeof define&&define.amd?define(["ScrollMagic"],r):"object"==typeof exports?r(require("scrollmagic")):r(e.ScrollMagic||e.jQuery&&e.jQuery.ScrollMagic)}(this,(function(e){"use strict";var r="debug.addIndicators",t=window.console||{},i=Function.prototype.bind.call(t.error||t.log||function(){},t);e||i("("+r+") -> ERROR: The ScrollMagic main module could not be found. Please make sure it's loaded before this plugin or use an asynchronous loader like requirejs.");var o="0.85em",n="9999",s=e._util,d=0;e.Scene.extend((function(){var e,r=this;r.addIndicators=function(t){if(!e){var i={name:"",indent:0,parent:void 0,colorStart:"green",colorEnd:"red",colorTrigger:"blue"};t=s.extend({},i,t),d++,e=new a(r,t),r.on("add.plugin_addIndicators",e.add),r.on("remove.plugin_addIndicators",e.remove),r.on("destroy.plugin_addIndicators",r.removeIndicators),r.controller()&&e.add()}return r},r.removeIndicators=function(){return e&&(e.remove(),this.off("*.plugin_addIndicators"),e=void 0),r}})),e.Controller.addOption("addIndicators",!1),e.Controller.extend((function(){var t=this,i=t.info(),o=i.container,n=i.isDocument,d=i.vertical,a={groups:[]};t._indicators&&function(){t._log&&(Array.prototype.splice.call(arguments,1,0,"("+r+")","->"),t._log.apply(this,arguments))}(2,"WARNING: Scene already has a property '_indicators', which will be overwritten by plugin."),this._indicators=a;var l=function(){a.updateBoundsPositions()},g=function(){a.updateTriggerGroupPositions()};return o.addEventListener("resize",g),n||(window.addEventListener("resize",g),window.addEventListener("scroll",g)),o.addEventListener("resize",l),o.addEventListener("scroll",l),this._indicators.updateBoundsPositions=function(e){for(var r,t,i,n=e?[s.extend({},e.triggerGroup,{members:[e]})]:a.groups,l=n.length,g={},p=d?"left":"top",c=d?"width":"height",u=d?s.get.scrollLeft(o)+s.get.width(o)-15:s.get.scrollTop(o)+s.get.height(o)-15;l--;)for(r=(i=n[l]).members.length,t=s.get[c](i.element.firstChild);r--;)g[p]=u-t,s.css(i.members[r].bounds,g)},this._indicators.updateTriggerGroupPositions=function(e){for(var r,i,l,g,p=e?[e]:a.groups,c=p.length,u=n?document.body:o,f=n?{top:0,left:0}:s.get.offset(u,!0),h=d?s.get.width(o)-15:s.get.height(o)-15,m=d?"width":"height",v=d?"Y":"X";c--;)i=(r=p[c]).element,g=(l=r.triggerHook*t.info("size"))>s.get[m](i.firstChild.firstChild)?"translate"+v+"(-100%)":"",s.css(i,{top:f.top+(d?l:h-r.members[0].options.indent),left:f.left+(d?h-r.members[0].options.indent:l)}),s.css(i.firstChild.firstChild,{"-ms-transform":g,"-webkit-transform":g,transform:g})},this._indicators.updateTriggerGroupLabel=function(e){var r="trigger"+(e.members.length>1?"":" "+e.members[0].options.name),t=e.element.firstChild.firstChild;t.textContent!==r&&(t.textContent=r,d&&a.updateBoundsPositions())},this.addScene=function(r){this._options.addIndicators&&r instanceof e.Scene&&r.controller()===t&&r.addIndicators(),this.$super.addScene.apply(this,arguments)},this.destroy=function(){o.removeEventListener("resize",g),n||(window.removeEventListener("resize",g),window.removeEventListener("scroll",g)),o.removeEventListener("resize",l),o.removeEventListener("scroll",l),this.$super.destroy.apply(this,arguments)},t}));var a=function(e,t){var i,o,n=this,a=l.bounds(),g=l.start(t.colorStart),p=l.end(t.colorEnd),c=t.parent&&s.get.elements(t.parent)[0],u=function(){e._log&&(Array.prototype.splice.call(arguments,1,0,"("+r+")","->"),e._log.apply(this,arguments))};t.name=t.name||d,g.firstChild.textContent+=" "+t.name,p.textContent+=" "+t.name,a.appendChild(g),a.appendChild(p),n.options=t,n.bounds=a,n.triggerGroup=void 0,this.add=function(){o=e.controller(),i=o.info("vertical");var r=o.info("isDocument");c||(c=r?document.body:o.info("container")),r||"static"!==s.css(c,"position")||s.css(c,{position:"relative"}),e.on("change.plugin_addIndicators",h),e.on("shift.plugin_addIndicators",f),G(),v(),setTimeout((function(){o._indicators.updateBoundsPositions(n)}),0),u(3,"added indicators")},this.remove=function(){if(n.triggerGroup){if(e.off("change.plugin_addIndicators",h),e.off("shift.plugin_addIndicators",f),n.triggerGroup.members.length>1){var r=n.triggerGroup;r.members.splice(r.members.indexOf(n),1),o._indicators.updateTriggerGroupLabel(r),o._indicators.updateTriggerGroupPositions(r),n.triggerGroup=void 0}else b();m(),u(3,"removed indicators")}};var f=function(){v()},h=function(e){"triggerHook"===e.what&&G()},m=function(){a.parentNode.removeChild(a)},v=function(){var r;a.parentNode!==c&&(r=o.info("vertical"),s.css(g.firstChild,{"border-bottom-width":r?1:0,"border-right-width":r?0:1,bottom:r?-1:t.indent,right:r?t.indent:-1,padding:r?"0 8px":"2px 4px"}),s.css(p,{"border-top-width":r?1:0,"border-left-width":r?0:1,top:r?"100%":"",right:r?t.indent:"",bottom:r?"":t.indent,left:r?"":"100%",padding:r?"0 8px":"2px 4px"}),c.appendChild(a));var n={};n[i?"top":"left"]=e.triggerPosition(),n[i?"height":"width"]=e.duration(),s.css(a,n),s.css(p,{display:e.duration()>0?"":"none"})},b=function(){o._indicators.groups.splice(o._indicators.groups.indexOf(n.triggerGroup),1),n.triggerGroup.element.parentNode.removeChild(n.triggerGroup.element),n.triggerGroup=void 0},G=function(){var r=e.triggerHook(),d=1e-4;if(!(n.triggerGroup&&Math.abs(n.triggerGroup.triggerHook-r)<d)){for(var a,g=o._indicators.groups,p=g.length;p--;)if(a=g[p],Math.abs(a.triggerHook-r)<d)return n.triggerGroup&&(1===n.triggerGroup.members.length?b():(n.triggerGroup.members.splice(n.triggerGroup.members.indexOf(n),1),o._indicators.updateTriggerGroupLabel(n.triggerGroup),o._indicators.updateTriggerGroupPositions(n.triggerGroup))),a.members.push(n),n.triggerGroup=a,void o._indicators.updateTriggerGroupLabel(a);if(n.triggerGroup){if(1===n.triggerGroup.members.length)return n.triggerGroup.triggerHook=r,void o._indicators.updateTriggerGroupPositions(n.triggerGroup);n.triggerGroup.members.splice(n.triggerGroup.members.indexOf(n),1),o._indicators.updateTriggerGroupLabel(n.triggerGroup),o._indicators.updateTriggerGroupPositions(n.triggerGroup),n.triggerGroup=void 0}!function(){var r=l.trigger(t.colorTrigger),d={};d[i?"right":"bottom"]=0,d[i?"border-top-width":"border-left-width"]=1,s.css(r.firstChild,d),s.css(r.firstChild.firstChild,{padding:i?"0 8px 3px 8px":"3px 4px"}),document.body.appendChild(r);var a={triggerHook:e.triggerHook(),element:r,members:[n]};o._indicators.groups.push(a),n.triggerGroup=a,o._indicators.updateTriggerGroupLabel(a),o._indicators.updateTriggerGroupPositions(a)}()}}},l={start:function(e){var r=document.createElement("div");r.textContent="start",s.css(r,{position:"absolute",overflow:"visible",display:"none","border-width":0,"border-style":"solid",color:e,"border-color":e});var t=document.createElement("div");return s.css(t,{position:"absolute",overflow:"visible",width:0,height:0}),t.appendChild(r),t},end:function(e){var r=document.createElement("div");return r.textContent="end",s.css(r,{position:"absolute",overflow:"visible",display:"none","border-width":0,"border-style":"solid",color:e,"border-color":e}),r},bounds:function(){var e=document.createElement("div");return s.css(e,{position:"absolute",overflow:"visible",display:"none","white-space":"nowrap","pointer-events":"none","font-size":o}),e.style.zIndex=n,e},trigger:function(e){var r=document.createElement("div");r.textContent="trigger",s.css(r,{position:"relative"});var t=document.createElement("div");s.css(t,{position:"absolute",overflow:"visible",display:"none","border-width":0,"border-style":"solid",color:e,"border-color":e}),t.appendChild(r);var i=document.createElement("div");return s.css(i,{position:"fixed",overflow:"visible","white-space":"nowrap","pointer-events":"none","font-size":o}),i.style.zIndex=n,i.appendChild(t),i}}}));